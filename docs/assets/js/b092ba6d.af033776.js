"use strict";(self.webpackChunksoftwarity=self.webpackChunksoftwarity||[]).push([[4391],{2677:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>c,toc:()=>l});var n=i(5893),s=i(1151);const r={title:"Gateway",authors:"fachache",tags:[]},o=void 0,c={id:"pres/concepts/gateway",title:"Gateway",description:"Routes",source:"@site/docs/pres/concepts/gateway.md",sourceDirName:"pres/concepts",slug:"/pres/concepts/gateway",permalink:"/pres/concepts/gateway",draft:!1,unlisted:!1,editUrl:"https://github.com/softwarity/website/tree/main/docs/pres/concepts/gateway.md",tags:[],version:"current",frontMatter:{title:"Gateway",authors:"fachache",tags:[]},sidebar:"presSidebar",previous:{title:"Features",permalink:"/pres/features"},next:{title:"Organization",permalink:"/pres/concepts/organization"}},d={},l=[{value:"Routes",id:"routes",level:2},{value:"Predicates",id:"predicates",level:2},{value:"Filters",id:"filters",level:2},{value:"Request Filters",id:"request-filters",level:3},{value:"Response Filters",id:"response-filters",level:3},{value:"Other Filters",id:"other-filters",level:3},{value:"Security",id:"security",level:2},{value:"Route Security",id:"route-security",level:3},{value:"Endpoint Security",id:"endpoint-security",level:3},{value:"Practical Case",id:"practical-case",level:2}];function a(e){const t={admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",ul:"ul",...(0,s.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"routes",children:"Routes"}),"\n",(0,n.jsxs)(t.p,{children:["Routes are the main elements of the ",(0,n.jsx)(t.code,{children:"Gateway"}),". They are defined by a destination ",(0,n.jsx)(t.code,{children:"URI"}),", a set of predicates, and a set of filters. A route is considered if the aggregated predicate is true."]}),"\n",(0,n.jsx)(t.admonition,{type:"note",children:(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"URI"})," is generally the ",(0,n.jsx)(t.code,{children:"DNS"})," of the microservice."]})}),"\n",(0,n.jsx)(t.h2,{id:"predicates",children:"Predicates"}),"\n",(0,n.jsx)(t.p,{children:"Predicates are the operations that condition the route. If all predicates are evaluated to true, then the route is taken."}),"\n",(0,n.jsxs)(t.p,{children:["These predicates can be an ",(0,n.jsx)(t.code,{children:"HTTP"})," header, a cookie, or something else, but it's generally an element of the path, the ",(0,n.jsx)(t.code,{children:"path"})," of the request."]}),"\n",(0,n.jsx)(t.admonition,{type:"note",children:(0,n.jsx)(t.p,{children:"The first route whose all predicates are verified is taken. It is therefore important to pay attention to the order of the routes."})}),"\n",(0,n.jsx)(t.h2,{id:"filters",children:"Filters"}),"\n",(0,n.jsx)(t.p,{children:"Filters allow modifying the flow."}),"\n",(0,n.jsx)(t.p,{children:"We can distinguish 3 types of filters."}),"\n",(0,n.jsx)(t.h3,{id:"request-filters",children:"Request Filters"}),"\n",(0,n.jsxs)(t.p,{children:["Request filters modify the elements constituting the request before sending it to the microservice designated by the ",(0,n.jsx)(t.code,{children:"URI"}),"."]}),"\n",(0,n.jsx)(t.admonition,{type:"info",children:(0,n.jsxs)(t.p,{children:["For example, the ",(0,n.jsx)(t.code,{children:"stripPrefix=1"})," filter allows removing from the path the piece that would have served as a predicate."]})}),"\n",(0,n.jsxs)(t.p,{children:["They also allow defining specific ",(0,n.jsx)(t.code,{children:"HTTP"})," headers or other modifications before being transmitted to the target service."]}),"\n",(0,n.jsx)(t.h3,{id:"response-filters",children:"Response Filters"}),"\n",(0,n.jsx)(t.p,{children:"Response filters allow modifying the response returned by the target service."}),"\n",(0,n.jsx)(t.admonition,{type:"info",children:(0,n.jsxs)(t.p,{children:["This kind of filter can add a button in the ",(0,n.jsx)(t.code,{children:"UI"}),"."]})}),"\n",(0,n.jsx)(t.h3,{id:"other-filters",children:"Other Filters"}),"\n",(0,n.jsx)(t.p,{children:"Other filters are those that do not fit into the first two categories."}),"\n",(0,n.jsx)(t.p,{children:"These are for example the filters for status modifications."}),"\n",(0,n.jsx)(t.admonition,{type:"note",children:(0,n.jsxs)(t.p,{children:["Most of the time you will set up a ",(0,n.jsx)(t.code,{children:"path"})," type predicate with a ",(0,n.jsx)(t.code,{children:"stripPrefix"})," request filter or a ",(0,n.jsx)(t.code,{children:"host"})," type predicate."]})}),"\n",(0,n.jsx)(t.h2,{id:"security",children:"Security"}),"\n",(0,n.jsxs)(t.p,{children:["Security is an important component of ",(0,n.jsx)(t.code,{children:"ARCHWAY"}),"."]}),"\n",(0,n.jsx)(t.p,{children:"2 types of requirements can be defined:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Authentication is required"}),"\n",(0,n.jsx)(t.li,{children:"The necessity to possess a role (implicit authentication)"}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"These requirements can be defined at 2 levels:"}),"\n",(0,n.jsx)(t.h3,{id:"route-security",children:"Route Security"}),"\n",(0,n.jsx)(t.p,{children:"The 2 requirements can be defined at the route level."}),"\n",(0,n.jsx)(t.p,{children:"This can be defined directly during the creation of the route."}),"\n",(0,n.jsx)(t.h3,{id:"endpoint-security",children:"Endpoint Security"}),"\n",(0,n.jsxs)(t.p,{children:["If the route exposes an endpoint allowing to retrieve the ",(0,n.jsx)(t.code,{children:"open-api"})," specifications, ",(0,n.jsx)(t.code,{children:"ARCHWAY"})," allows defining for each endpoint the security requirements."]}),"\n",(0,n.jsx)(t.h2,{id:"practical-case",children:"Practical Case"}),"\n",(0,n.jsxs)(t.p,{children:["For example, consider the ",(0,n.jsx)(t.code,{children:"foo-service"})," microservice that listens on port 3000."]}),"\n",(0,n.jsx)(t.p,{children:"The route could be:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["Predicate: ",(0,n.jsx)(t.code,{children:"path=/foo/**"})," defining that all requests starting with ",(0,n.jsx)(t.code,{children:"/foo/**"})," will be redirected to ",(0,n.jsx)(t.code,{children:"foo-service"}),"\nBut the ",(0,n.jsx)(t.code,{children:"foo-service"})," does not have ",(0,n.jsx)(t.code,{children:"foo"})," in its context path.\nSo we will use the request filter to remove this unnecessary part."]}),"\n",(0,n.jsxs)(t.li,{children:["Filter: ",(0,n.jsx)(t.code,{children:"stripPrefix=1"}),"\nNow the web application that wants to request the ",(0,n.jsx)(t.code,{children:"foo-service"})," can just request ",(0,n.jsx)(t.code,{children:"/foo/..."})]}),"\n"]}),"\n",(0,n.jsx)(t.admonition,{type:"info",children:(0,n.jsxs)(t.p,{children:["Thus the ",(0,n.jsx)(t.code,{children:"API Gateway"})," will route the request ",(0,n.jsx)(t.code,{children:"/foo/v1/item"})," to ",(0,n.jsx)(t.code,{children:"http://foo-service:3000/v1/item"})]})}),"\n",(0,n.jsxs)(t.admonition,{type:"note",children:[(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.code,{children:"ARCHWAY"})," can transmit user information to the ",(0,n.jsx)(t.code,{children:"foo-service"})]}),(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["via ",(0,n.jsx)(t.code,{children:"HTTP"})," headers"]}),"\n",(0,n.jsxs)(t.li,{children:["via a ",(0,n.jsx)(t.code,{children:"JWT"})," token"]}),"\n"]})]})]})}function h(e={}){const{wrapper:t}={...(0,s.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(a,{...e})}):a(e)}},1151:(e,t,i)=>{i.d(t,{Z:()=>c,a:()=>o});var n=i(7294);const s={},r=n.createContext(s);function o(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);