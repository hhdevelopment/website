"use strict";(self.webpackChunksoftwarity=self.webpackChunksoftwarity||[]).push([[7748],{3001:(e,s,i)=>{i.r(s),i.d(s,{assets:()=>l,contentTitle:()=>d,default:()=>u,frontMatter:()=>n,metadata:()=>c,toc:()=>o});var t=i(5893),r=i(1151);const n={title:"Gateway",authors:"fachache",tags:[]},d=void 0,c={id:"pres/concepts/gateway",title:"Gateway",description:"Routes",source:"@site/versioned_docs/version-1.0.1/pres/concepts/gateway.md",sourceDirName:"pres/concepts",slug:"/pres/concepts/gateway",permalink:"/1.0.1/pres/concepts/gateway",draft:!1,unlisted:!1,editUrl:"https://github.com/softwarity/website/tree/main/versioned_docs/version-1.0.1/pres/concepts/gateway.md",tags:[],version:"1.0.1",frontMatter:{title:"Gateway",authors:"fachache",tags:[]},sidebar:"presSidebar",previous:{title:"Fonctionnalit\xe9s",permalink:"/1.0.1/pres/features"},next:{title:"Contr\xf4le d'acc\xe9s",permalink:"/1.0.1/pres/concepts/access-control"}},l={},o=[{value:"Routes",id:"routes",level:2},{value:"Pr\xe9dicats",id:"pr\xe9dicats",level:2},{value:"Filtres",id:"filtres",level:2},{value:"Les filtres de requ\xeates",id:"les-filtres-de-requ\xeates",level:3},{value:"Les filtres de r\xe9ponses",id:"les-filtres-de-r\xe9ponses",level:3},{value:"Les autres filtres",id:"les-autres-filtres",level:3},{value:"Securit\xe9",id:"securit\xe9",level:2},{value:"S\xe9curit\xe9 de la <code>route</code>",id:"s\xe9curit\xe9-de-la-route",level:3},{value:"S\xe9curit\xe9 des <code>endpoints</code>",id:"s\xe9curit\xe9-des-endpoints",level:3},{value:"Cas pratique",id:"cas-pratique",level:2}];function a(e){const s={admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",ul:"ul",...(0,r.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.h2,{id:"routes",children:"Routes"}),"\n",(0,t.jsxs)(s.p,{children:["Les routes sont les \xe9l\xe9ments principals de la ",(0,t.jsx)(s.code,{children:"Gateway"}),". Elles sont d\xe9finis par un ",(0,t.jsx)(s.code,{children:"URI"})," de destination, un ensemble de pr\xe9dicats et un ensemble de filtres. Une route est prise en compte si le pr\xe9dicat agr\xe9g\xe9 est vrai."]}),"\n",(0,t.jsx)(s.admonition,{type:"note",children:(0,t.jsxs)(s.p,{children:["L'",(0,t.jsx)(s.code,{children:"URI"})," est en g\xe9n\xe9ral le ",(0,t.jsx)(s.code,{children:"DNS"})," du microservice."]})}),"\n",(0,t.jsx)(s.h2,{id:"pr\xe9dicats",children:"Pr\xe9dicats"}),"\n",(0,t.jsx)(s.p,{children:"Les pr\xe9dicats sont les op\xe9rations qui conditionnent la route. Si tous les pr\xe9dicats sont evalu\xe9 \xe0 vrai alors la route est emprunt\xe9e."}),"\n",(0,t.jsxs)(s.p,{children:["Ces pr\xe9dicats peuvent \xeatre un ent\xeate ",(0,t.jsx)(s.code,{children:"HTTP"}),", un cookie ou autre, mais c'est g\xe9n\xe9ralement un \xe9lement du chemin, le ",(0,t.jsx)(s.code,{children:"path"})," de la requ\xeate."]}),"\n",(0,t.jsx)(s.h2,{id:"filtres",children:"Filtres"}),"\n",(0,t.jsx)(s.p,{children:"Les filtres permettent de modifier le flux."}),"\n",(0,t.jsx)(s.p,{children:"Nous pouvons distinguer 3 sortes de filtres."}),"\n",(0,t.jsx)(s.h3,{id:"les-filtres-de-requ\xeates",children:"Les filtres de requ\xeates"}),"\n",(0,t.jsxs)(s.p,{children:["Les filtres de requ\xeates modifient les \xe9lements constituant la requ\xeate avant de l'envoyer au microservice d\xe9sign\xe9 par l'",(0,t.jsx)(s.code,{children:"URI"}),"."]}),"\n",(0,t.jsx)(s.admonition,{type:"info",children:(0,t.jsxs)(s.p,{children:["Par exemple le filtre de ",(0,t.jsx)(s.code,{children:"stripPrefix=1"})," permet de supprimer du chemin le morceau qui aurait servit de pr\xe9dicat."]})}),"\n",(0,t.jsxs)(s.p,{children:["Ils permettent aussi de d\xe9finir des ent\xeates ",(0,t.jsx)(s.code,{children:"HTTP"})," sp\xe9cifique ou autre modifications avant d\xeatre transmit au service cible."]}),"\n",(0,t.jsx)(s.h3,{id:"les-filtres-de-r\xe9ponses",children:"Les filtres de r\xe9ponses"}),"\n",(0,t.jsx)(s.p,{children:"Les filtres de r\xe9ponses permettent quand \xe0 eux de modifier la r\xe9ponse retourn\xe9e par le service cible."}),"\n",(0,t.jsx)(s.h3,{id:"les-autres-filtres",children:"Les autres filtres"}),"\n",(0,t.jsx)(s.p,{children:"Les autres filtres, sont les filtres qui ne rentrent pas dans les 2 premi\xe8res cat\xe9gories."}),"\n",(0,t.jsx)(s.p,{children:"Ce sont par exemple les filtres de modifications de status."}),"\n",(0,t.jsx)(s.admonition,{type:"note",children:(0,t.jsxs)(s.p,{children:["La plupart du temps vous parametrerez un pr\xe9dicat de type ",(0,t.jsx)(s.code,{children:"path"})," et un filtre de requ\xeate ",(0,t.jsx)(s.code,{children:"stripPrefix"}),"."]})}),"\n",(0,t.jsx)(s.h2,{id:"securit\xe9",children:"Securit\xe9"}),"\n",(0,t.jsxs)(s.p,{children:["La s\xe9curit\xe9 est une composante importante de ",(0,t.jsx)(s.code,{children:"ARCHWAY"}),"."]}),"\n",(0,t.jsx)(s.p,{children:"3 type d'exigences peuvent \xeatre d\xe9finit"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"L'authentification est exig\xe9e"}),"\n",(0,t.jsx)(s.li,{children:"La n\xe9cessit\xe9 de posseder un r\xf4le (authentification implicite)"}),"\n",(0,t.jsx)(s.li,{children:"L'acc\xe9s est r\xe9serv\xe9 seulement \xe0 certain utilisateurs (authentification implicite)"}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"Ces exigences peuvent \xeatre d\xe9finit \xe0 2 niveaux"}),"\n",(0,t.jsxs)(s.h3,{id:"s\xe9curit\xe9-de-la-route",children:["S\xe9curit\xe9 de la ",(0,t.jsx)(s.code,{children:"route"})]}),"\n",(0,t.jsx)(s.p,{children:"Les 3 exigences peuvent \xeatre d\xe9finit au niveau de la route."}),"\n",(0,t.jsx)(s.p,{children:"Ceci peut \xeatre d\xe9finit directement lors de la cr\xe9ation de la route"}),"\n",(0,t.jsxs)(s.h3,{id:"s\xe9curit\xe9-des-endpoints",children:["S\xe9curit\xe9 des ",(0,t.jsx)(s.code,{children:"endpoints"})]}),"\n",(0,t.jsxs)(s.p,{children:["Si la route expose un enpoint permettant de r\xe9cuperer les specifications ",(0,t.jsx)(s.code,{children:"open-api"}),", ",(0,t.jsx)(s.code,{children:"ARCHWAY"})," permet de d\xe9finir pour chaque endpoint les exigences de s\xe9curit\xe9."]}),"\n",(0,t.jsx)(s.h2,{id:"cas-pratique",children:"Cas pratique"}),"\n",(0,t.jsxs)(s.p,{children:["Par exemple, consid\xe9rons le microservice ",(0,t.jsx)(s.code,{children:"foo-service"})," qui ecoute sur le port 3000."]}),"\n",(0,t.jsx)(s.p,{children:"La route pourrait \xeatre :"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Pr\xe9dicat: ",(0,t.jsx)(s.code,{children:"path=/foo/**"})," d\xe9finissant que toutes les requ\xeates commencant par ",(0,t.jsx)(s.code,{children:"/foo/**"})," devront \xeatre redirig\xe9e vers ",(0,t.jsx)(s.code,{children:"foo-service"}),"\nMais le service ",(0,t.jsx)(s.code,{children:"foo-service"})," n'a pas dans sont chemin de contexte ",(0,t.jsx)(s.code,{children:"foo"}),".\nOn va donc utiliser le filtre de requ\xeate pour enlever cette partie superflue."]}),"\n",(0,t.jsxs)(s.li,{children:["Filtre: ",(0,t.jsx)(s.code,{children:"stripPrefix=1"}),"\nMaintenant l'application web qui voudra requ\xeater le service ",(0,t.jsx)(s.code,{children:"foo-service"})," pourra juste requ\xeater ",(0,t.jsx)(s.code,{children:"/foo/..."})]}),"\n"]}),"\n",(0,t.jsx)(s.admonition,{type:"info",children:(0,t.jsxs)(s.p,{children:["Ainsi l'",(0,t.jsx)(s.code,{children:"API Gateway"})," routera le requ\xeate ",(0,t.jsx)(s.code,{children:"/foo/v1/item"})," vers ",(0,t.jsx)(s.code,{children:"http://foo-service:3000/vi/item"})]})}),"\n",(0,t.jsxs)(s.admonition,{type:"note",children:[(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"ARCHWAY"})," pourra en plus exig\xe9 que l'initiateur de la reuqu\xeate soit authentifi\xe9. Et pourra transmettre les informations utilisateurs au service ",(0,t.jsx)(s.code,{children:"foo-service"})]}),(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["via des ent\xeates ",(0,t.jsx)(s.code,{children:"HTTP"})]}),"\n",(0,t.jsxs)(s.li,{children:["via un token ",(0,t.jsx)(s.code,{children:"JWT"})]}),"\n"]})]})]})}function u(e={}){const{wrapper:s}={...(0,r.a)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},1151:(e,s,i)=>{i.d(s,{Z:()=>c,a:()=>d});var t=i(7294);const r={},n=t.createContext(r);function d(e){const s=t.useContext(n);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),t.createElement(n.Provider,{value:s},e.children)}}}]);