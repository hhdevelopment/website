version: '3.8'
services:
  archway:
    image: ghcr.io/hhdevelopment/archway:latest
    ports:
      # highlight-next-line
      - 8443:8443 # HTTPS
    volumes:
      # highlight-next-line
      - ./config:/config:ro
    environment:
      # highlight-start
      SERVER_PORT: 8443
      SSL: "true"
      SSL_KEY_ALIAS: 1
      SSL_KEY_STORE_PASSWORD: changeit
      SSL_KEY_STORE: config/server-keystore.p12
      SSL_KEY_STORE_TYPE: PKCS12
      # highlight-end
      MONGODB_HOST: mongodb 
      MONGODB_DB_NAME: archway
      MONGODB_USER: admin
      MONGODB_PWD: changeit

  mongodb:
    image: mongo # official image  
    volumes:
      - mongodb_data:/data/db
    environment:
      MONGO_INITDB_DATABASE: archway
      MONGO_INITDB_ROOT_USERNAME: admin
      MONGO_INITDB_ROOT_PASSWORD: changeit
volumes:
  mongodb_data: